You are continuing an existing project skills2crypto.
Do NOT redesign UI.
Do NOT add demo logic.
Do NOT add mock win/lose buttons.
Work ONLY on real-time multiplayer infrastructure.

GOAL

Implement a real-time match lifecycle using socket.io, where:

the server is the single source of truth

two real players are connected to the same match

frontend only listens and renders

no game result logic yet

no escrow yet

This is STEP 2 of the architecture.

SERVER (REQUIRED)
1. Install and enable socket.io on the backend

Attach socket.io to the existing HTTP server (port 5000)

Do NOT create a second server

2. Match registry (in-memory for now)

Create a global structure:

matches = {
  [matchId]: {
    id,
    game,
    asset,
    amount,
    players: {
      [playerId]: {
        socketId,
        connected: true
      }
    },
    status: "waiting" | "active" | "paused" | "finished",
    state: {}
  }
}

3. Socket events (SERVER)

Implement the following socket.io events:

join_match

Payload:

{
  "matchId": "...",
  "playerId": "..."
}


Behavior:

Attach socket to the match

Mark player as connected

If both players are connected → set status = active

Emit match_state to all players

disconnect

Behavior:

Mark player as disconnected

Set match status = paused

Emit updated match_state

leave_match

Behavior:

Mark player disconnected

Keep match alive

Emit match_state

4. match_state event (SERVER → CLIENT)

Emit on:

join

disconnect

reconnect

Payload:

{
  "matchId",
  "status",
  "players": {
    "playerId": {
      "connected": true | false
    }
  }
}

FRONTEND (REQUIRED)
5. Socket connection

Connect to socket.io only after a match is created

Do NOT connect globally on app load

6. On /play/:game

Connect socket

Emit join_match

Subscribe to match_state

Store match state in React state

7. UI behavior

If status = waiting → show “Waiting for opponent…”

If status = paused → show “Opponent disconnected”

If status = active → render game container (no logic yet)

Do NOT show any debug labels

Do NOT show win/lose/draw buttons

IMPORTANT CONSTRAINTS

NO mock results

NO client-side decision making

NO fallback to Chess

NO demo mode

Server controls everything

SUCCESS CRITERIA

When two browser tabs:

join the same match

both connect via socket.io

both see real-time status updates

disconnecting one tab updates the other